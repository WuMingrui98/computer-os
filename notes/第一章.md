# 第一章 计算机系统概述

## 1.1 操作系统的基本概念

### 1.1.1 操作系统的概念、功能和目标

#### 1. 思维导图总览

![image-20211222180231602](https://tva1.sinaimg.cn/large/008i3skNly1gxmrn9nqjzj31b40qaadk.jpg)

#### 2. 熟悉的操作系统举例

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlfue4151j311g0idta9.jpg)

#### 3. 操作系统的层次结构

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlfuwfp46j31180hetbh.jpg)

#### 4. 操作系统的概念

* 是系统最基本最核心的软件，属于系统软件
* 控制和管理整个计算机的硬件和软件资源
* 合理的组织、调度计算机的工作与资源的分配
* 为用户和其它软件提供方便的接口和环境

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlfw6jd55j314s0jatey.jpg)

#### 5. 操作系统的功能和目标

* 先放一张思维导图，大致知道操作系统的具体功能和目标，然后再一一展开叙述。

![008i3skNly1gxlfy0qhanj31f50h1gp6](https://tva1.sinaimg.cn/large/008i3skNly1gxlgj4lsepj31f50h1wi7.jpg)

- 用一个直观的例子来理解上述图中操作系统的功能：

> * 我们假设：用户是雇主，操作系统是工人（用来操作机器），计算机是机器（由处理机(CPU)、存储器、设备、文件几个部件构成）
> * 工人有熟练的技能去控制和协调各个部件的工作，这就是**操作系统对资源的管理**
> * 同时，工人必须接受雇主的命令，这就是**接口**
> * 有了工人，机器就能发挥更大的作用，因此工人就成了**扩充机器**
> * 工人操作机器、机器有了更大的作用比如GUI界面，于是工人便成了**扩充机器**，去扩充GUI界面等功能

##### (1) 作为计算机系统资源的管理者

* 管理软硬件资源、合理的组织、调度计算机的工作与资源的分配

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlg1iiaw6j30bi0a2mxj.jpg)

###### 1⃣️ 处理器（CPU）管理

* 在多道程序环境下，CPU的分配和运行都以进程（或线程）为基本单位，因此对CPU的管理可理解为对进程的管理。进程管理的主要功能包括**进程控制、进程同步、进程通信、死锁处理、处理机调度**等。附上一张图理解对进程的管理。

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlg32yif9j31fo0lyk2t.jpg)

###### 2️⃣ 存储器管理

* 为多道程序的运行提供良好的环境，方便用户使用及提高内存的利用率，主要包括**内存分配与回收、地址映射、内存保护与共享和内存扩充**等功能。

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlg4mn60ej31fo0lyal4.jpg)

###### 3️⃣ 文件管理

* 计算机中所有的信息都是以文件的形式存在的，操作系统中负责文件的管理的部分称为文件系统，文件管理包括**文件存储空间的管理、目录管理及文件读写管理和保护**等。

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlg5zs770j30lb09w0tt.jpg)

###### 4️⃣ 设备管理

* 设备管理的主要任务是完成用户的I/O请求，方便用户使用各种设备，并提高设备的利用率，主要**包括缓存管理、设备分配、设备处理和虚拟设备**等功能。

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlg7dhmr1j30y80ol78k.jpg)

- 以上4种管理功能都由“工人”负责，“雇主”无序关注。

##### (2) 作为用户与计算机硬件系统之间的接口

- 为了让用户方便、快捷、可靠的操作计算机硬件并执行自己的程序，操作系统提供了用户接口
- 操作系统提供的接口分为两类：**命令接口和程序接口**
- **命令接口**：用户可以**直接**使用的，利用这些操作命令来组织和控制作业的执行
- **程序接口**：用户通过程序**间接**使用的，编程人员可以使用它们来请求操作系统服务

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlg9yom36j30bl09y0t2.jpg)

###### 1️⃣ 命令接口

- 命令接口分为两类：联机命令接口和脱机命令接口，用户可以**直接**调用
- **联机命令接口**：又称交互式命令接口，适用于分时或实时系统的接口，由一组键盘操作命令组成。用户输入一条指令，操作系统就执行一条指令；

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlgbmwnpaj31600f3tak.jpg)

* **脱机命令接口**：又称批处理接口，使用于批处理系统，由一组作业控制命令组成。用户输入一堆指令，操作系统运行一堆指令。在操作系统运行这些命令时用户不可干预。

> 批处理(Batch)，也称为批处理脚本。顾名思义，批处理就是对某对象进行批量的处理，通常被认为是一种简化的脚本语言，它应用于DOS和Windows系统中。批处理文件的扩展名为bat 。
>
> ![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlgcndc5vj30wf0gkwhh.jpg)

###### 2️⃣ 程序接口

- 程序接口：由一组**系统调用**（也称广义指令）组成
- 用户通过在程序中使用这些系统调用来请求操作系统为其提供服务，只能通过用户程序**间接**调用
- 如使用各种外部设备、申请分配和回收内存及其它各种要求

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlgefrodoj313e03qq3k.jpg)

> 动态链接库英文为DLL，是Dynamic Link Library的缩写。DLL是一个包含可由多个程序，同时使用的代码和数据的库。

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlgmnloruj30ei03tt8q.jpg)

###### 3⃣️ GUI

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlgmg5vqcj316i0injw4.jpg)

##### (3) 作为扩充机器（虚拟机）

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlgn10b9dj30bm0a8jrp.jpg)

- 没有任何软件支持的计算机称为**裸机**
- 覆盖了软件的机器称为**扩充机器或虚拟机**

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlgnnsxspj314z07pjtn.jpg)

### 1.1.2 操作系统的特征

#### 1. 思维导图总览

- 操作系统是一种系统软件，但与其它系统软件和应用软件有很大的不同，它有自己的特殊性，及基本特征。

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlgoft91yj313k0gowgz.jpg)

#### 2. 并发

- **并发**：两个或多个事件在同一**时间间隔内**发生，这些事件在宏观上是同时发生的，在微观上是交替发生的， 操作系统的并发性指系统中同时存在着多个运行的程序
- **并行**：两个或多个事件在同一**时刻**发生

- 一个单核(CPU)同一时刻只能执行一个程序，因此操作系统会协调多个程序使他们交替进行（这些程序在宏观上是同时发生的，在微观上是交替进行的）
- 操作系统是伴随着“多道程序技术出现的”，因此操作系统和并发是一同诞生的

* 在如今的计算机中，一般都是多核CPU的，即在同一**时刻**可以并行执行多个程序，比如我的计算机是8核的，我的计算机可以在同一时刻并行执行8个程序，但是事实上我们计算机执行的程序并不止8个，因此并发技术是必须存在的，并发性必不可少。

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlgrqrdupj30lk0mq77e.jpg)

#### 3. 共享

- 资源共享即共享，是指系统中的资源可以**供内存中多个并发执行的进程**共同使用
- 共享分为两类：互斥共享和同时共享

##### (1) 互斥共享

- 计算机中的某个资源在一段时间内只能允许**一个进程**访问，别的进程没有使用权
- 临界资源(独占资源)：在一段时间内只允许一个进程访问的资源，计算机中大多数物理设备及某些软件中的栈、变量和表格都属于临界资源，它们被要求互斥共享
- 举个例子：比如QQ和微信视频。同一段时间内摄像头只能分配给其中一个进程

##### (2) 同时共享

- 计算机中的某个资源在在一段时间内可以**同时**允许**多个**进程访问
- 同时共享通常要求一个请求分为几个时间片段间隔的完成，即交替进行，“分时共享”

- 这里的**同时**指在宏观上是同时的，在微观上是交替进行访问的，只是CPU处理速度很快，我们感觉不到，在宏观上感觉是在同时进行

- 举个例子：比如QQ在发送文件A，微信在发送文件B，宏观上两个进程A和B都在访问磁盘，在我们看来是同时进行的，但是在微观上两个进程A和B是交替进行访问磁盘的，只是时间太短，CPU处理速度太快，我们感觉不到。

##### (3) 并发性和共享性互为存在条件

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlgw0mp34j31120cigob.jpg)

#### 4. 虚拟

> 多道程序设计：是指在计算机内存中同时存放几道相互独立的程序，使它们在管理程序控制之下，相互穿插的运行。 两个或两个以上程序在计算机系统中同处于开始到结束之间的状态。这就称为多道程序设计。多道程序技术运行的特征：多道、宏观上并行、微观上串行。

- 虚拟是把一个物理上的实体变为若干逻辑上的对应物
- 物理实体（前者）是实际存在的；而后者是虚的，是用户感觉上的事务
- 虚拟技术：用于实现虚拟的技术
- 虚拟处理器（CPU）：通过多道程序设计技术，采用让多道程序并发执行的方法，分时来使用一个CPU，实际物理上只有一个CPU，但是用户感觉到有多个CPU
- 虚拟存储器：从逻辑上扩充存储器容量，用户感觉到的但实际不存在的存储器
- 虚拟设备：将一台物理设备虚拟为逻辑上的多台设备，使多个用户在同一时间段内访问同一台设备，即同时共享，用户宏观上感觉是同时的，但实际上是微观交替访问同一台设备的
- 操作系统的虚拟技术科归纳为：
  - 时分复用技术：如处理器的分时共享
  - 空间复用技术：如虚拟存储器

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlgz7qsyrj30tx0bmq4c.jpg)

#### 5. 异步

* 异步：多道程序环境允许多个程序**并发**执行，但由于资源有限，如CPU只有一个，进程的执行并不是一贯到底的，而是走走停停的，它以不可预知的速度向前推进。
* 比如A进程正在占用CPU计算，B进程这时也想占用CPU计算，B进程只有等，等A进程算完了，A进程去访问磁盘资源了，这时B进程再占用CPU进行计算，B进程还没计算完，A进程从磁盘取出资源了，A进程发现B这时在占用CPU，这时A进程就需要等待，等B算完后再继续到CPU中进行计算。由于每个进程占用资源的时间不固定，所以进程的执行以不可预知的速度前进。

## 1.2 操作系统的发展和分类

### 1.2.1 操作系统的发展和分类

#### 1. 思维导图总览

![image-20211222180614136](https://tva1.sinaimg.cn/large/008i3skNly1gxmrr429rqj31bk0pqdk0.jpg)

#### 2. 操作系统的分类及其特征优劣

![watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzkxNDYwNA==,size_16,color_FFFFFF,t_70](https://tva1.sinaimg.cn/large/008i3skNly1gxlh6uo2u3j30u00wsgqh.jpg)

#### 3. 操作系统的发展历程

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlh7adkujj30u60biwg6.jpg)

## 1.3 操作系统的运行机制和体系结构

### 1.3.1 操作系统的运行机制和体系结构

#### 1. 思维导图总览

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlh8bujy4j31bg0u0wkp.jpg)

#### 2. 操作系统内核在计算机系统中的层次结构

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlhazdtatj312q0hwjti.jpg)

#### 3. 操作系统体系结构类比

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlhbkvljrj311408ltb2.jpg)

#### 4. 操作系统用户态和核心态的转换

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlhc1lk1oj30ha096my5.jpg)

### 1.3.2 中断和异常

#### 1. 思维导图总览

![image-20211222180821904](https://tva1.sinaimg.cn/large/008i3skNly1gxmrtax73cj31ay0qaq7n.jpg)

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlhd2l6w4j31270u0gpz.jpg)

#### 2. 中断的诞生

通过引入中断机制，实现多道程序并发执行

**本质**：发生中断就意味着**需要操作系统介入，开展管理工作**

#### 3. 中断的概念和作用

* 当中断发生后，CPU立刻进入**核心态**
* 当中断发生后，当前运行的进程暂停运行，并由操作系统内核对中断进行处理
* 对于不同的中断信号，会进行不同的处理

#### 4. 中断的分类

![image-20211221153307945](https://tva1.sinaimg.cn/large/008i3skNly1gxlhpha7clj31iy0matci.jpg)

![image-20211221153331828](https://tva1.sinaimg.cn/large/008i3skNly1gxlhpw38i6j31bi0i2q5w.jpg)

#### 5. 外中断的处理过程

![image-20211221153445249](https://tva1.sinaimg.cn/large/008i3skNly1gxlhr5yl0nj31hm0ton1f.jpg)

### 1.3.3 系统调用

#### 1. 思维导图总览

![image-20211222180940550](https://tva1.sinaimg.cn/large/008i3skNly1gxmruns7jnj31ao0q6q7v.jpg)

![watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzkxNDYwNA==,size_16,color_FFFFFF,t_70](https://tva1.sinaimg.cn/large/008i3skNly1gxlhyeh07dj31fk0ivgr1.jpg)

#### 2. 系统调用和库函数的区别

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxli0wwho3j317v0j2781.jpg)

#### 3. 系统调用的执行过程

![在这里插入图片描述](https://tva1.sinaimg.cn/large/008i3skNly1gxlhzgq2j5j315j0lrtf3.jpg)

